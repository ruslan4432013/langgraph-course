"""
Пример 10: Продвинутые концепции
Демонстрирует: расширенные методы поиска и оптимизация
"""

print("=" * 70)
print("ПРОДВИНУТЫЕ КОНЦЕПЦИИ ВЕКТОРНЫХ ХРАНИЛИЩ")
print("=" * 70)

print("""
1. МАКСИМАЛЬНАЯ МАРГИНАЛЬНАЯ РЕЛЕВАНТНОСТЬ (MMR)
   ────────────────────────────────────────────
   • Диверсифицирует результаты поиска
   • Избегает возврата похожих и дублирующихся документов
   • Полезна когда нужны разнообразные результаты
   • Применяется после первоначального поиска по сходству

   Пример использования (для поддерживающих хранилищ):
     results = vector_store.max_marginal_relevance_search(
         query="python",
         k=5,
         fetch_k=20  # Получить больше кандидатов для диверсификации
     )

2. ГИБРИДНЫЙ ПОИСК
   ───────────────
   • Объединяет поиск по ключевым словам и семантический поиск
   • Сочетает преимущества обоих подходов
   • Поиск по ключевым словам: точное совпадение
   • Семантический поиск: понимание смысла

   Сценарий использования:
     - Технические документы (нужна точность + понимание)
     - E-commerce (бренды + семантика)
     - Системы поддержки (FAQ + контекст)

   Поддержку проверяйте в документации конкретного хранилища.

3. ФИЛЬТРАЦИЯ ПО МЕТАДАННЫМ
   ────────────────────────
   • Ограничивает поиск документами, удовлетворяющими условиям
   • Примеры условий:
     - source: "tweet" (только твиты)
     - date >= "2024-01-01" (документы после даты)
     - category: ["AI", "ML"] (несколько категорий)

   Пример:
     results = vector_store.similarity_search(
         query="python",
         k=5,
         filter={"source": "article", "year": 2024}
     )

4. ИНДЕКСИРОВАНИЕ И ПРОИЗВОДИТЕЛЬНОСТЬ
   ────────────────────────────────────
   • HNSW: Иерархический Навигируемый Малый Мир
   • Хеширование локально-чувствительное (LSH)
   • Квантизация векторов для уменьшения памяти

   Выбор индекса влияет на:
     - Скорость поиска
     - Использование памяти
     - Качество результатов

5. МАСШТАБИРУЕМОСТЬ
   ────────────────
   • Для маленьких объемов: InMemoryVectorStore
   • Для средних объемов: Chroma, FAISS, Milvus
   • Для больших объемов: Pinecone, Weaviate, Qdrant

   Рекомендации по выбору зависят от:
     - Размера данных
     - Требований к скорости
     - Наличия фильтрации
     - Бюджета

6. ОБНОВЛЕНИЕ И УПРАВЛЕНИЕ ДАННЫМИ
   ───────────────────────────────
   • Используйте ID для идентификации документов
   • Обновление: delete() + add_documents() с тем же ID
   • Удаление устаревших документов
   • Пакетные операции для производительности
""")

print("\n" + "=" * 70)
print("РЕКОМЕНДАЦИИ ДЛЯ ВЫБОРА ПРАВИЛЬНОГО ПОДХОДА:")
print("=" * 70)
print("""
┌─────────────────┬──────────────┬──────────────┬─────────────┐
│ Использование   │ Размер       │ Хранилище    │ Особенности │
├─────────────────┼──────────────┼──────────────┼─────────────┤
│ Прототипирование│ < 10K док.   │ InMemory     │ Простое     │
│ Демонстрация    │              │ FAISS        │             │
├─────────────────┼──────────────┼──────────────┼─────────────┤
│ Production      │ 10K-1M       │ Chroma       │ Персистент  │
│ (малое)         │              │ Milvus       │ Фильтры     │
├─────────────────┼──────────────┼──────────────┼─────────────┤
│ Production      │ 1M+          │ Pinecone     │ Облако      │
│ (большое)       │              │ Weaviate     │ Масштаб     │
│                 │              │ Qdrant       │ SLA         │
└─────────────────┴──────────────┴──────────────┴─────────────┘
""")
