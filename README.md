# Учебный пример: Map-Reduce в LangGraph

Этот проект демонстрирует реализацию паттерна **Map-Reduce** с использованием
библиотеки [LangGraph](https://github.com/langchain-ai/langgraph).

## Описание

В данном примере реализован процесс генерации и выбора лучшей шутки на заданную тему. Процесс разделен на три ключевых
этапа:

1. **Генерация подтем (Fan-out)**: На основе входной темы (например, "Животные") генерируется список из нескольких
   подтем.
2. **Параллельная генерация (Map)**: Для каждой подтемы параллельно запускается процесс генерации отдельной шутки. Это
   демонстрирует возможность LangGraph эффективно масштабировать выполнение задач.
3. **Выбор лучшей шутки (Reduce)**: Все сгенерированные шутки собираются в едином узле, который выбирает одну "лучшую"
   шутку на основе заданных критериев.

## Визуализация графа

Ниже представлен граф процесса, описанный в файле `src/best_joke_graph.py`:

![Граф Map-Reduce](static/img.png)

## Установка и запуск

### 1. Клонирование репозитория и установка зависимостей

Убедитесь, что у вас установлен Python. Затем выполните:

```bash
pip install -r requirements.txt
```

### 2. Настройка переменных окружения

Создайте файл `.env` в корне проекта и добавьте в него необходимые ключи:

```env
OPENAI_API_KEY=ваш_ключ_openai

# Настройки LangSmith (опционально)
LANGSMITH_TRACING=true
LANGSMITH_ENDPOINT=https://api.smith.langchain.com
LANGSMITH_API_KEY=ваш_ключ_langsmith
LANGSMITH_PROJECT=ваш_проект
```

### 3. Запуск примера

Запустите основной скрипт:

```bash
python src/best_joke_graph.py
```

## Структура проекта

- `src/best_joke_graph.py` — описание и компиляция графа.
- `src/settings.py` — управление настройками и переменными окружения.
- `static/img.png` — визуализация структуры графа.
- `langgraph.json` — конфигурация для использования с LangGraph CLI.
